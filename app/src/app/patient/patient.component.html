<mat-sidenav-container fxFlexFill>
  <mat-sidenav #sidenav mode="side">
    <app-record-filter [categories]="availableCategories$ | async" [tags]="availableTags$ | async"
                       (change)="setFilter($event)"></app-record-filter>
    <div [hidden]="!sidenav.opened" fxFlex="40px">
      <button (click)="sidenav.toggle()" aria-label="Open Filter" color="primary" mat-icon-button>
        <mat-icon>menu_open</mat-icon>
      </button>
    </div>
  </mat-sidenav>
  <mat-sidenav-content fxLayout="row">
    <div [hidden]="sidenav.opened" fxFlex="40px">
      <button (click)="sidenav.toggle()" aria-label="Open Filter" color="primary" mat-icon-button>
        <mat-icon>menu</mat-icon>
      </button>
    </div>
    <app-multi-record-list (clickRecord)="onSelectRecord($event)" (duplicate)="onDuplicateRecord($event)" [@panelInOut]
                           [categories]="categories$ | async" [patient]="patient$ | async"
                           [records]="records$ | async"
                           [selectedCategory]="selectedCategory$ | async"
                           (selectedCategoryChange)="onSelectedCategoryChange($event)"
                           (updateRecord)="onUpdateRecord($event)"
                           (deleteRecord)="onDeleteRecord($event)"
                           (openInEditor)="onOpenInEditor($event)"
                           class="record-overview"
                           fxFlex>
    </app-multi-record-list>

    <mat-card (@panelInOut.done)="onAnimationEvent($event)" (keydown.escape)="showDetails = false" *ngIf="showDetails"
              [@panelInOut] class="record-details" fxFlex="65%" tabindex="0">
      <mat-card-header>
        <mat-card-title *ngIf="selectedRecord$ | async as selectedRecord;">
          <h2>{{ selectedRecord.category | category | async }}: {{ selectedRecord.date | date: 'mediumDate' }}</h2>
        </mat-card-title>
        <div fxFlex></div>
        <button (click)="showDetails= false" mat-icon-button>
          <mat-icon aria-label="close">close</mat-icon>
        </button>
      </mat-card-header>
      <div mat-card-image>
        <app-record-viewer [record]="selectedRecord$ | async"></app-record-viewer>
      </div>

    </mat-card>
  </mat-sidenav-content>
</mat-sidenav-container>
