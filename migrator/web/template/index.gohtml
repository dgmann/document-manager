<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./static/styles.css">
    <title>Migrator</title>
</head>
<body>
{{- /*gotype: github.com/dgmann/document-manager/migrator/http.Server*/ -}}
<div>
    <h1>Anzahl Elemente in der Datenbank</h1>
    <p>Patienten {{ .DatabaseManager.Index.Index.GetTotalPatientCount }}</p>
    <p>Befunde {{ .DatabaseManager.Index.Index.GetTotalRecordCount }}</p>
</div>

<div>
    <h1>Anzahl Elemente im Dateisystem</h1>
    <p>Patienten {{ .FilesystemManager.Index.Index.GetTotalPatientCount }}</p>
    <p>Befunde {{ .FilesystemManager.Index.Index.GetTotalRecordCount }}</p>
</div>

<div>
    <h1>Ergebnisse der Pr√ºfung</h1>
    {{ $result := validate }}
    <h2>Behebbar</h2>
    {{template "record-table" index $result "resolvable"}}
    <h2>Fehler</h2>
    <ul>
        {{range index $result "validationErrors"}}
            <li>{{.}}</li>
        {{end}}
    </ul>
</div>

<div>
    <h1>Status</h1>
    <p>Importierte Befunde {{ len .ImportManager.ImportedRecords }}</p>
    <p>Fehlgeschlagene Befunde {{ len .ImportManager.ImportedRecords }}</p>
    {{if (len .ImportManager.ImportedRecords) gt 0}}
        {{template "record-table" .ImportManager.ImportedRecords}}
    {{end}}
</div>
</body>
</html>

{{define "record-table"}}
    <table>
        <tr>
            <th>Patientennummer</th>
            <th>Fachrichtung</th>
            <th>Pfad</th>
        </tr>
        {{range .}}
            <tr>
                {{- /*gotype: github.com/dgmann/document-manager/migrator/records/models.RecordContainer*/ -}}
                {{ $record := .Record }}
                <td>{{$record.PatId}}</td>
                <td>{{$record.Spez}}</td>
                <td>{{$record.Path}}</td>
            </tr>

        {{end}}
    </table>
{{end}}